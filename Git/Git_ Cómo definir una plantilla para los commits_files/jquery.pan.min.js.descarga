/*@license
Fullscreen Image Zoom and Pan with Jquery
version 4.0.1

Original version by Samil Hazir (https://github.com/saplumbaga)
later versions by JM Alarcon (https://github.com/jmalarcon/)

https://github.com/saplumbaga/jquery.pan
https://github.com/jmalarcon/jquery.pan
 */
jQuery.fn.extend({pan:function(showRotationControls){var rc,ra,panWrapper=document.createElement("div"),panImg=($(panWrapper).addClass("panWrapper"),document.createElement("img")),loadingImg=($(panImg).addClass("i").css("position","absolute"),document.createElement("div")),loadingImg=($(loadingImg).attr("id","loading").addClass("loading"),$(panWrapper).append(loadingImg),document.createElement("div")),zi=($(loadingImg).addClass("buttonsWrapper"),document.createElement("a")),zo=($(zi).addClass("controls in"),document.createElement("a")),link=($(zo).addClass("controls out"),(showRotationControls=0!=showRotationControls)&&(rc=document.createElement("a"),$(rc).addClass("controls rc"),ra=document.createElement("a"),$(ra).addClass("controls ra")),document.createElement("a")),close=($(link).addClass("controls link"),document.createElement("a")),loadingImg=($(close).addClass("controls close"),$(panWrapper).append(close),$(loadingImg).append(zi),showRotationControls&&$(loadingImg).append(rc),$(loadingImg).append(link),showRotationControls&&$(loadingImg).append(ra),$(loadingImg).append(zo),$(panWrapper).append(panImg),$(panWrapper).append(loadingImg),$("body").append(panWrapper),$(this).filter(function(){if($(this).attr("data-big"))return!0;var imgElts=function(root){if("IMG"==root.tagName)return[root];root=$(root).find("img");return 0<root.length?root.get():null}(this);if(0<imgElts.length){for(var i=0;i<imgElts.length;i++)if(function(imgElt){if(imgElt){if(imgElt.getAttribute("data-big"))return 1;var nW=imgElt.naturalWidth||0,nH=imgElt.naturalHeight||0,w=$(imgElt).outerWidth(),imgElt=$(imgElt).outerHeight();return w<nW||imgElt<nH}}(imgElts[i]))return!0;return!1}return!1}));function __getPointerPos(event,prop){var pos=event[prop];return null==pos&&(pos=0,event.touches?pos=event.touches[0][prop]:event.originalEvent&&event.originalEvent.touches&&(pos=event.originalEvent.touches[0][prop])),pos}function panInit(event){event.preventDefault();var panImg=$(".panWrapper img.i"),panWrapper=$(".panWrapper"),w=parseInt(panImg.css("width")),h=parseInt(panImg.css("height")),vpW=$(panWrapper).width(),vpH=$(panWrapper).height(),angle=parseInt(panImg.data("rotAngle"))||0,ml=-((w=angle%180!=0?[h,h=w][0]:w)-vpW),mt=-(h-vpH),scrollHOffset=window.pageXOffset||document.documentElement.scrollLeft,scrollVOffset=window.pageYOffset||document.documentElement.scrollTop,scrollHOffset=function(event){return __getPointerPos(event,"pageX")}(event)-scrollHOffset;(vpW=$(panWrapper).width())<(scrollHOffset=scrollHOffset<0?0:scrollHOffset)&&(scrollHOffset=vpW);var event=function(event){return __getPointerPos(event,"pageY")}(event)-scrollVOffset,nl=((vpH=$(panWrapper).height())<(event=event<0?0:event)&&(event=vpH),Math.floor(ml*scrollHOffset/vpW)),nt=Math.floor(mt*event/vpH),scrollVOffset=(vpW-w)/2,panWrapper=(vpH-h)/2,tX=(w<vpW&&h<vpH?(nl=scrollVOffset,nt=panWrapper):w<vpW?nl=scrollVOffset:h<vpH&&(nt=panWrapper),0),tY=0;switch(angle%360){case 0:tX=nl,tY=nt;break;case 90:case-270:tX=nt,tY=-(w+nl);break;case 180:case-180:tX=-(w+nl),tY=-(h+nt);break;case 270:case-90:tX=-h-nt,tY=nl}panImg.css("transform","rotate("+angle+"deg) translate("+tX+"px,"+tY+"px)")}return loadingImg.css("cursor","zoom-in"),loadingImg.on("click",function(e){var t=$(this),big=t.attr("data-big");if(null==big){if("IMG"!=e.target.tagName)return;big=e.target.getAttribute("data-big")||e.target.src}var href=t.attr("href"),linkElt=t,t=(href||0<(t=t.parents("a")).length&&(href=(linkElt=$(t[0])).attr("href")),href&&$(link).attr("href",href).attr("target",linkElt.attr("target")).attr("title",linkElt.attr("title")?linkElt.attr("title"):href),$("#loading").addClass("loading"),$(".panWrapper img.i").attr("src",""));return $(".panWrapper").show(),t.css("width","auto").attr("src",big).on("load",function(){$("#loading").removeClass("loading"),panInit(e)}),!1}),$(zi).on("click",function(e){var panImg=$(".panWrapper img.i");panImg.css("width",parseInt(1.2*parseInt(panImg.css("width")))),panInit(e)}),$(zo).on("click",function(e){var panImg=$(".panWrapper img.i");panImg.css("width",parseInt(parseInt(panImg.css("width"))/1.2)+1),panInit(e)}),showRotationControls&&($(rc).on("click",function(e){var panImg=$(".panWrapper img.i").first(),angle=parseInt(panImg.data("rotAngle"))||0;panImg.css({transform:"rotate("+(angle=(angle+90)%360)+"deg)"}),panImg.data("rotAngle",angle),panInit(e)}),$(ra).on("click",function(e){var panImg=$(".panWrapper img.i").first(),angle=panImg.data("rotAngle")||0;panImg.css({transform:"rotate("+(angle=(angle-90)%360)+"deg)"}),panImg.data("rotAngle",angle),panInit(e)})),$(close).on("click",function(e){$(".panWrapper").fadeOut("slow",function(){var panImg=$(".panWrapper img.i").first();panImg.data("rotAngle",0),panImg.css({transform:"rotate(0)"}),$(link).removeAttr("href").removeAttr("target")})}),$(panImg).on("click",function(){$(close).trigger("click")}),$(panWrapper).on("mousemove touchmove",function(e){panInit(e)}),$("body").on("keydown",function(e){27==e.keyCode&&$(close).trigger("click")}),$(panWrapper).mousewheel(function(wheelEvent){(0<wheelEvent.deltaY?$(zo):$(zi)).trigger("click"),panInit(wheelEvent)}),loadingImg}}),function(){var _addEventListener,support,prefix="";window.addEventListener?_addEventListener="addEventListener":(_addEventListener="attachEvent",prefix="on"),void 0!==document.onmousewheel&&(support="mousewheel");try{WheelEvent("wheel"),support="wheel"}catch(e){}function _addWheelListener(elem,eventName,callback,useCapture){elem[_addEventListener](prefix+eventName,"wheel"==support?callback:function(originalEvent){var event={originalEvent:originalEvent=originalEvent||window.event,target:originalEvent.target||originalEvent.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==originalEvent.type?0:1,deltaX:0,delatZ:0,pageX:originalEvent.pageX,pageY:originalEvent.pageY,preventDefault:function(){originalEvent.preventDefault?originalEvent.preventDefault():originalEvent.returnValue=!1}};return"mousewheel"==support?(event.deltaY=-.025*originalEvent.wheelDelta,originalEvent.wheelDeltaX&&(event.deltaX=-.025*originalEvent.wheelDeltaX)):event.deltaY=originalEvent.detail,callback(event)},useCapture||!1)}support=support||"DOMMouseScroll",window.addWheelListener=function(elem,callback,useCapture){_addWheelListener(elem,support,callback,useCapture),"DOMMouseScroll"==support&&_addWheelListener(elem,"MozMousePixelScroll",callback,useCapture)},$.fn.mousewheel=function(handler){return this.each(function(){window.addWheelListener(this,handler,!0)})}}(jQuery);
//# sourceMappingURL=jquery.pan.min.js.map